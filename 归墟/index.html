<!DOCTYPE html>
<!-- 类脑/旅程梦星作品，禁止二传，禁止商业化，均无偿免费开源分享 -->
<html lang="zh-CN">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>归墟 - 宿命轮回</title>
  <link rel="stylesheet" href="https://sparkling-hummingbird-1a2fc4.netlify.app/归墟/css/guixu.css" />
</head>

<body>
  <!-- 类脑/旅程梦星作品，禁止二传，禁止商业化，均无偿免费开源分享 -->
  <div class="guixu-root-container">
    <!-- 视图切换按钮 -->
    <button id="view-toggle-btn" class="view-toggle-btn" title="切换视图">📱</button>

    <div class="game-container">
      <!-- 顶部状态栏 -->
      <div class="top-status">
        <div class="status-item">
          <div class="status-label">境界</div>
          <div id="val-jingjie" class="status-value">...</div>
        </div>
        <div class="status-item">
          <div class="status-label">当前纪年</div>
          <div id="val-jinian" class="status-value">...</div>
        </div>
        <div class="status-item">
          <div class="status-label">归墟充能</div>
          <div id="val-guixu-charge-text" class="status-value">...%</div>
          <div id="bar-guixu-charge" class="guixu-charge">
            <div class="guixu-fill"></div>
          </div>
        </div>
      </div>

      <!-- 左侧角色面板 -->
      <div class="character-panel">
        <div class="panel-section">
          <div class="section-title">核心属性 <span style="font-size: 10px; color: #8b7355">(当前/上限)</span></div>
          <div class="attributes-list">
            <div class="attribute-item">
              <span class="attribute-name">法力</span><span id="attr-fali" class="attribute-value">...</span>
            </div>
            <div class="attribute-item">
              <span class="attribute-name">神海</span><span id="attr-shenhai" class="attribute-value">...</span>
            </div>
            <div class="attribute-item">
              <span class="attribute-name">道心</span><span id="attr-daoxin" class="attribute-value">...</span>
            </div>
            <div class="attribute-item">
              <span class="attribute-name">空速</span><span id="attr-kongsu" class="attribute-value">...</span>
            </div>
            <div class="attribute-item">
              <span class="attribute-name">气运</span><span id="attr-qiyun" class="attribute-value">...</span>
            </div>
            <div class="attribute-item">
              <span class="attribute-name">生理年龄</span><span id="attr-shengli" class="attribute-value">...</span>
            </div>
            <div class="attribute-item">
              <span class="attribute-name">心理年龄</span><span id="attr-xinli" class="attribute-value">...</span>
            </div>
          </div>
        </div>

        <div class="panel-section">
          <div class="section-title">天赋灵根</div>
          <div id="talent-linggen-list" class="attributes-list">
            <!-- 天赋和灵根动态填充 -->
          </div>
        </div>

        <div class="panel-section">
          <div class="section-title">当前装备</div>
          <div class="equipment-grid">
            <div id="equip-wuqi" class="equipment-slot">武器</div>
            <div id="equip-fangju" class="equipment-slot">防具</div>
            <div id="equip-shipin" class="equipment-slot">饰品</div>
            <div id="equip-fabao1" class="equipment-slot">法宝</div>
            <div id="equip-zhuxiuGongfa" class="equipment-slot">主修功法</div>
            <div id="equip-fuxiuXinfa" class="equipment-slot">辅修心法</div>
          </div>
        </div>
      </div>

      <!-- 中央内容区 -->
      <div class="main-content">
        <div id="game-text-display" class="game-text-container">
          <gametxt> 欢迎来到《归墟》的世界。你的宿命，由此开始。 </gametxt>
        </div>
      </div>

      <!-- 右侧交互面板 -->
      <div class="interaction-panel">
        <button id="btn-inventory" class="interaction-btn">背包</button>
        <button id="btn-relationships" class="interaction-btn">人物关系</button>
        <button id="btn-command-center" class="interaction-btn">指令中心</button>
        <button id="btn-character-details" class="interaction-btn">角色详情</button>
        <button id="btn-guixu-system" class="interaction-btn">归墟系统</button>
        <button id="btn-show-extracted" class="interaction-btn">查看提取内容</button>
        <button id="btn-save-load-manager" class="interaction-btn">存档/读档</button>

        <!-- 世界书控制 -->
        <div id="world-book-controls" class="panel-section" style="padding: 8px; margin-top: 10px;">
          <div class="section-title" style="font-size: 11px; margin-bottom: 6px;">世界书控制</div>
          <div style="display: flex; flex-direction: column; gap: 8px;">
            <div style="display: flex; align-items: center; justify-content: space-between;">
              <label for="unified-index-input" style="font-size: 11px; color: #8b7355;">读写序号:</label>
              <input type="number" id="unified-index-input" value="1" min="1"
                style="width: 60px; background: rgba(0,0,0,0.5); border: 1px solid #8b7355; color: #e0dcd1; border-radius: 4px; padding: 4px; font-size: 12px;">
            </div>
            <div style="display: flex; align-items: center; gap: 6px;">
              <input type="checkbox" id="auto-toggle-lorebook-checkbox" style="cursor: pointer;">
              <label for="auto-toggle-lorebook-checkbox" class="auto-write-label"
                style="font-size: 11px;">自动开关世界书</label>
            </div>
          </div>
        </div>

        <!-- 世界线回顾 -->
        <div class="world-line-section">
          <div class="world-line-title">世界线回顾</div>
          <div style="display: flex; gap: 10px; justify-content: center;">
            <button id="btn-view-journey-main" class="interaction-btn primary-btn"
              style="flex-grow: 1; white-space: nowrap;">本世历程</button>
            <button id="btn-view-past-lives-main" class="interaction-btn primary-btn"
              style="flex-grow: 1; white-space: nowrap;">往世涟漪</button>
          </div>
        </div>
      </div>

      <!-- 底部状态与快速发送 -->
      <div id="bottom-status-container" class="bottom-status">
        <div id="status-effects-wrapper" style="display: flex; gap: 8px; overflow-x: auto">
          <div class="status-effect">
            <div class="effect-icon"></div>
            <span>当前无状态效果</span>
          </div>
        </div>
        <div class="quick-send-container">
          <button id="btn-quick-commands" class="interaction-btn" style="padding: 5px 12px">当前指令</button>
          <textarea id="quick-send-input" class="quick-send-input" placeholder="请在此输入回复..."></textarea>
          <button id="btn-quick-send" class="interaction-btn" style="padding: 5px 12px">发送</button>
        </div>
      </div>
    </div>

    <!-- 装备详情悬浮提示框 -->
    <div id="equipment-tooltip"></div>

    <!-- 快速指令弹出菜单 -->
    <div id="quick-command-popup"></div>

    <!-- 文件导入隐藏input -->
    <input type="file" id="import-file-input" style="display: none;" accept=".json" />
  </div>

  <!-- 加载本地模块化脚本（按依赖顺序） -->
  <script src="https://sparkling-hummingbird-1a2fc4.netlify.app/归墟/js/utils/constants.js"></script>
  <script src="https://sparkling-hummingbird-1a2fc4.netlify.app/归墟/js/utils/logging.js"></script>
  <script src="https://sparkling-hummingbird-1a2fc4.netlify.app/归墟/js/utils/safe-get.js"></script>
  <script src="https://sparkling-hummingbird-1a2fc4.netlify.app/归墟/js/core/storage.js"></script>
  <script src="https://sparkling-hummingbird-1a2fc4.netlify.app/归墟/js/core/api.js"></script>
  <script src="https://sparkling-hummingbird-1a2fc4.netlify.app/归墟/js/core/state.js"></script>
  <script src="https://sparkling-hummingbird-1a2fc4.netlify.app/归墟/js/services/text-extract.js"></script>
  <script src="https://sparkling-hummingbird-1a2fc4.netlify.app/归墟/js/services/attributes.js"></script>
  <script src="https://sparkling-hummingbird-1a2fc4.netlify.app/归墟/js/services/lorebook.js"></script>
  <script src="https://sparkling-hummingbird-1a2fc4.netlify.app/归墟/js/services/mvu-bridge.js"></script>
  <script src="https://sparkling-hummingbird-1a2fc4.netlify.app/归墟/js/ui/dom.js"></script>
  <script src="https://sparkling-hummingbird-1a2fc4.netlify.app/归墟/js/ui/modal.js"></script>
  <script src="https://sparkling-hummingbird-1a2fc4.netlify.app/归墟/js/ui/inventory.js"></script>
  <script src="https://sparkling-hummingbird-1a2fc4.netlify.app/归墟/js/guixu.js"></script>
</body>

</html>
